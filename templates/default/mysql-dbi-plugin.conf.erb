#
# This file is generated by Chef
# Do not edit, changes will be overwritten
#
LoadPlugin "<%= @name %>"

<% if not @config.empty? %>
<Plugin "<%= @name %>">
  <% query = @config["Query"]
     db = @config["Database"]
  %>
  <% query.each do |q| %>
    <Query <%= collectd_option(q.delete("Name")) %>>
      <% result = q.delete("Result") %>
      <% q.each_pair do |key, value| %>
	<%= key %> <%= collectd_option(value) %>
      <% end %>
      <% result.each do |res| %>
	<Result>
	  <% res.each_pair do |key, value| %>
	    <%= key %> <%= collectd_option(value) %>
	  <% end %>
	</Result>
      <% end %>
    </Query>
  <% end %>
  <% db.each do |d| %>
    <Database <%= collectd_option(d.delete("Name")) %>>
      Driver "mysql"
      <% d["DriverOptions"].each_pair do |key, value| %>
      DriverOption "<%= key %>" <%= collectd_option(value) %>
      <% end %>
      Query <%= collectd_option(d["Query"]) %>
    </Database>
  <% end %>
</Plugin>
<% end %>
